<link rel="shortcut icon" href="images/favicon.png" type="image/x-icon" />

<header class="header">
  <div class="header-top">
    <div class="com-img-wrap">
      <a href="../index.html">
        <img
          src="../images/logo_wrap/logo_not_hover.png"
          alt="주식회사 24시응급환자이송센터"
        />
      </a>
    </div>

    <nav class="header-nav-wrap">
      <div class="wrap">
        <div class="nav-wrap">
          <button class="nav font-pm">회사소개</button>
        </div>
        <div class="nav-sub-wrap">
          <button class="nav-sub font-pl">
            <a href="../about_sub01.html#companyintroduce" class="font-pl"
              >인사말</a
            >
          </button>
          <button class="nav-sub font-pl">
            <a href="../about_sub01.html#companybranch" class="font-pl"
              >조직도</a
            >
          </button>
        </div>
      </div>
      <div class="wrap">
        <div class="nav-wrap">
          <button class="nav font-pm">주요업무</button>
        </div>
        <div class="nav-sub-wrap">
          <button class="nav-sub font-pl">
            <a href="../task_sub01.html" class="font-pl">환자이송</a>
          </button>
        </div>
      </div>
      <div class="wrap">
        <div class="nav-wrap">
          <button class="nav font-pm">행사의료지원</button>
        </div>
        <div class="nav-sub-wrap">
          <button class="nav-sub font-pl">
            <a href="../event_sub01.html#event" class="font-pl">행사의료지원</a>
          </button>
          <button class="nav-sub font-pl">
            <a href="../event_sub01.html#gallery" class="font-pl">갤러리</a>
          </button>
        </div>
      </div>
      <div class="wrap">
        <div class="nav-wrap">
          <button class="nav font-pm">고객센터</button>
        </div>
        <div class="nav-sub-wrap">
          <button class="nav-sub font-pl">
            <a href="../cus_center.html#notice" class="font-pl">공지사항</a>
          </button>
          <button class="nav-sub font-pl">
            <a href="../cus_center.html#F&Q" class="font-pl">자주 묻는 질문</a>
          </button>
          <button class="nav-sub font-pl">
            <a href="../cus_center.html#inquiry" class="font-pl">문의하기</a>
          </button>
        </div>
      </div>
    </nav>

    <div class="call-wrap">
      <a href="tel:1800-7432" class="call-number">
        <i class="xi-call"></i>
        <p class="num font-pr">1800-7432</p>
      </a>
    </div>

    <div class="mobile-header-btn">
      <button class="header-btn">
        <img src="../images/mobile_btn.png" />
      </button>
    </div>
  </div>
</header>
<div class="overlay"></div>
<div class="mobile-header-menu">
  <div class="close-btn-wrap">
    <button class="close-btn">
      <i class="xi-close"></i>
    </button>
  </div>

  <div class="mobile-header-main">
    <div class="com-img-wrap">
      <a href="">
        <img src="../images/logo_wrap/logo_b.png" alt="24시응급" />
      </a>
    </div>
    <div class="mobile-nav-wrap">
      <button class="mobile-nav">
        <p class="nav-text font-pb">회사소개</p>
        <i class="xi-angle-down"></i>
      </button>
      <div class="mobile-nav-detail">
        <a href="../about_sub01.html#companyintroduce">
          <p class="nav-text font-pr">인사말</p>
        </a>
        <a href="../about_sub01.html#companybranch">
          <p class="nav-text font-pr">조직도</p>
        </a>
      </div>
    </div>
    <div class="mobile-nav-wrap">
      <button class="mobile-nav">
        <p class="nav-text font-pb">주요업무</p>
        <i class="xi-angle-down"></i>
      </button>
      <div class="mobile-nav-detail">
        <a href="../task_sub01.html">
          <p class="nav-text font-pr">환자이송</p>
        </a>
      </div>
    </div>
    <div class="mobile-nav-wrap">
      <button class="mobile-nav">
        <p class="nav-text font-pb">행사의료지원</p>
        <i class="xi-angle-down"></i>
      </button>
      <div class="mobile-nav-detail">
        <a href="../event_sub01.html#event">
          <p class="nav-text font-pr">행사의료지원</p>
        </a>
        <a href="../event_sub01.html#gallery">
          <p class="nav-text font-pr">갤러리</p>
        </a>
      </div>
    </div>
    <div class="mobile-nav-wrap">
      <button class="mobile-nav">
        <p class="nav-text font-pb">고객센터</p>
        <i class="xi-angle-down"></i>
      </button>
      <div class="mobile-nav-detail">
        <a href="../cus_center.html#notice">
          <p class="nav-text font-pr">공지사항</p>
        </a>
        <a href="../cus_center.html#F&Q">
          <p class="nav-text font-pr">자주 묻는 질문</p>
        </a>
        <a href="../cus_center.html#inquiry">
          <p class="nav-text font-pr">문의하기</p>
        </a>
      </div>
    </div>
  </div>
</div>

<script>
  if (!location.pathname.endsWith("index.html") || !location.pathname === "/") {
    console.log("active");

    const header = document.getElementById("header");
    const logo = document.querySelector(
      ".header .header-top .com-img-wrap img"
    );

    header.addEventListener("mouseover", () => {
      logo.src = "../images/logo_wrap/logo_hover.png";
    });
    header.addEventListener("mouseout", () => {
      logo.src = "../images/logo_wrap/logo_not_hover.png";
    });
  }
</script>

<script>
  function updatePagination() {
    // 활성 슬라이드를 찾음
    const activeSlide = document.querySelector(
      ".swiper-slide.swiper-slide-active"
    );
    const paginationItems = document.querySelectorAll(
      ".swiper-pagination-bullet"
    );

    if (activeSlide) {
      const ariaLabel = activeSlide.getAttribute("aria-label");
      if (ariaLabel) {
        const slideIndex = parseInt(ariaLabel.split(" / ")[0]) - 1;

        // 페이지네이션 상태 업데이트
        paginationItems.forEach((item, index) => {
          if (index === slideIndex) {
            item.classList.add("swiper-pagination-bullet-active");
          } else {
            item.classList.remove("swiper-pagination-bullet-active");
          }
        });

        // 강제적으로 "5 / 5"일 때 처리
        if (ariaLabel === "5 / 5") {
          console.log("Last slide is active"); // 디버깅용 로그
          paginationItems.forEach((item, index) => {
            // 마지막 슬라이드에 맞는 페이지네이션만 활성화
            if (index === paginationItems.length - 1) {
              item.classList.add("swiper-pagination-bullet-active");
            } else {
              item.classList.remove("swiper-pagination-bullet-active");
            }
          });
        }
      }
    }
  }

  function headerChange() {
    const activeSlide = document.querySelector(
      ".swiper-slide.swiper-slide-active"
    );
    const textElements = document.querySelectorAll(
      ".header .header-top .header-nav-wrap .nav-wrap .nav"
    );
    const headerLogo = document.querySelector(
      ".header .header-top .com-img-wrap a img"
    );
    const callContainer = document.querySelector(
      ".header .header-top .call-wrap"
    );
    const callIcon = document.querySelector(
      ".header .header-top .call-wrap a i"
    );
    const callText = document.querySelector(
      ".header .header-top .call-wrap a .num"
    );
    const header = document.getElementById("header");
    const mobileMenu = document.querySelector(
      ".header .header-top .mobile-header-btn .header-btn"
    );

    if (activeSlide) {
      const ariaLabel = activeSlide.getAttribute("aria-label");
      if (ariaLabel && ariaLabel.startsWith("1 /")) {
        textElements.forEach((el) => {
          el.style.color = ""; // 기본 색상으로 되돌리기
        });
        headerLogo.src = "../images/logo_wrap/logo_not_hover.png";
        callContainer.style.borderColor = "";
        callIcon.style.color = "";
        callText.style.color = "";
        header.style.backgroundColor = "";
        mobileMenu.style.filter = "";

        header.addEventListener("mouseover", () => {
          headerLogo.src = "../images/logo_wrap/logo_hover.png";
        });
        header.addEventListener("mouseout", () => {
          headerLogo.src = "../images/logo_wrap/logo_not_hover.png";
        });
      } else {
        textElements.forEach((el) => {
          el.style.color = "#202020"; // 특정 색상으로 변경
        });
        headerLogo.src = "../images/logo_wrap/logo_hover.png";
        callContainer.style.borderColor = "#5fc700";
        callIcon.style.color = "#202020";
        callText.style.color = "#202020";
        mobileMenu.style.filter = "invert(100%)";
        header.style.backgroundColor = "#fff";
        header.addEventListener("mouseover", () => {
          headerLogo.src = "../images/logo_wrap/logo_hover.png";
        });
        header.addEventListener("mouseout", () => {
          headerLogo.src = "../images/logo_wrap/logo_hover.png";
        });
      }
    }
  }

  // Swiper 초기화
  // const mainSwiper = new Swiper(".containerSwiper", {
  //   speed: 500,
  //   direction: "vertical",
  //   mousewheel: true,
  //   pagination: {
  //     el: ".swiper-pagination",
  //     clickable: true,
  //   },
  //   on: {
  //     slideChangeTransitionEnd: () => {
  //       headerChange(); // 슬라이드 전환 후 헤더 업데이트
  //       setTimeout(updatePagination, 100); // 페이지네이션 업데이트
  //     },
  //     touchEnd: () => {
  //       headerChange(); // 터치 끝난 후 헤더 업데이트
  //       setTimeout(updatePagination, 100); // 페이지네이션 업데이트
  //     },
  //   },
  // });

  // 초기 로드 시 헤더와 페이지네이션 업데이트
  window.addEventListener("load", () => {
    headerChange();
    updatePagination();
  });
</script>

<script>
  // 1280px 초과 시 .mobile-header-menu 숨기기
  const mobileHeaderMenu = document.querySelector(".mobile-header-menu");
  const overlay = document.querySelector(".overlay");

  window.addEventListener("resize", () => {
    if (window.innerWidth > 1280) {
      mobileHeaderMenu.style.display = "none";
      overlay.style.display = "none"; // 배경도 숨김
    }
  });

  if (window.innerWidth > 1280) {
    mobileHeaderMenu.style.display = "none";
    overlay.style.display = "none";
  }

  // .header-btn 클릭 시 .mobile-header-menu 표시
  const headerBtn = document.querySelector(".mobile-header-btn .header-btn");
  headerBtn.addEventListener("click", () => {
    mobileHeaderMenu.style.display = "flex";
    overlay.style.display = "block";
  });

  // .close-btn 클릭 시 .mobile-header-menu 숨기기
  const closeBtn = document.querySelector(".close-btn-wrap .close-btn");
  closeBtn.addEventListener("click", () => {
    mobileHeaderMenu.style.display = "none";
    overlay.style.display = "none";
  });

  overlay.addEventListener("click", () => {
    mobileHeaderMenu.style.display = "none";
    overlay.style.display = "none";
  });

  // .mobile-nav 클릭 시 .mobile-nav-detail 표시/숨김 및 아이콘 변경
  const mobileNavButtons = document.querySelectorAll(".mobile-nav");
  mobileNavButtons.forEach((button) => {
    button.addEventListener("click", () => {
      const navDetail = button.nextElementSibling; // .mobile-nav-detail
      const icon = button.querySelector("i");
      const text = button.querySelector("p");

      if (navDetail.style.display === "block") {
        // 현재 열려 있으면 닫기
        navDetail.style.display = "none";
        icon.classList.remove("xi-angle-up");
        icon.classList.add("xi-angle-down");
        button.style.backgroundColor = "";
        text.style.color = "";
        icon.style.color = "";
      } else {
        // 현재 닫혀 있으면 열기
        navDetail.style.display = "block";
        icon.classList.remove("xi-angle-down");
        icon.classList.add("xi-angle-up");
        button.style.backgroundColor = "#599224";
        text.style.color = "#FFF";
        icon.style.color = "#FFF";
      }
    });
  });

  // 초기 상태에서 모든 .mobile-nav-detail 숨기기
  document.querySelectorAll(".mobile-nav-detail").forEach((detail) => {
    detail.style.display = "none";
  });
</script>
